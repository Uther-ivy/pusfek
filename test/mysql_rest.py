import json
import traceback

import pymysql
import requests
from lxml import etree

import tool



def pooldb_conn():
    try:
        pooldb  = pymysql.connect(
    host='47.92.73.25',
    port=3306,
    user='duxie',
    password='jtkpwangluo.com',
    database='ytb',
    charset='utf8'
)
        return pooldb
    except Exception as e:
        traceback.format_exc()
        pooldb_conn()

def close_mysql(cur,pooldb):
    cur.close()
    pooldb.close()

def excute_mysql(sql, params=None, commit=False):

        pooldb = pooldb_conn()
        cur = pooldb.cursor()
        try:
            cur.execute(sql,params)
            if commit:
                pooldb.commit()
            data = cur.fetchall()
            return data
        except Exception as e:
            print(f"Error: {e}\n {sql}")
            print(traceback.format_exc())
        finally:
            close_mysql(cur,pooldb)
def update_shi(id,code):
    sql = f"update dede_arctiny set shi='{code}',nativeplace='{code}' where id='{id}';"
    data = excute_mysql(sql, commit=True)
    print(data)
    return data
def update_sheng(id,code):
    sql = f"update dede_arctiny set sheng='{code}' where id='{id}';"
    data = excute_mysql(sql, commit=True)
    print(data)
    return data

def updata_body(id ,code):
    sql = f"update dede_arctiny set body='{code}' where id='{id}';"
    data = excute_mysql(sql, commit=True)
    print(data)
    return data

def search_data( args):
    sql=f"select  id ,url,title,senddate from dede_arctiny where id ='{args}';"
    data = excute_mysql(sql, commit=True)
    print(data)
    return data
def get_aid_api():
    url='http://srms.jianqicha.com.cn/Sphinx/pythonIDs?pages=1&shi=&url=&title=潍坊经济开发区人力'
    session=requests.Session()
    res=session.get(url).content.decode()
    print(res)
    return res

def run_(all_id):
#     all_id=[61286455,61300735,61312647,61350711,61369493,61384589,61398917,61412589,61429167,61443645,61459197,61474481,61489395,61503645,61514995,61527797,61542117,61554457,61567471,61580309,61590735,61604199,61618261,61625047,61641597,61655155,61669149,61682675,61694855,61718967,61731127,61742799,61751931,61763597,61772609,61785771,61795049,61803749,61810811,61818511,61826335,61830879,61838253,61845207,61852429,61859529,61866091,61872983,61879641,61885041,61888561,61892023,61896677,61901165,61909029,61913713,61920641,61924249,61927939,61932041,61936119,61939399,61945285,61949289,61953265,61957543,61960269,61963191,8890,9836,4398242,6191635,6191641,6191643,6191645,6191659,6191661,6196638,6217085,6217089,6217095,6218643,6218645,6218651,6218657,6221133,6221135,6224065,6224071,6224073,6224075,6224077,6243111,6243113,6243117,6243119,6294935,6294941,6456625,6456637,6456651,6456661,6456679,6456727,6456741,6456763,6456787,6456817,6491273,6491279,6491281,6493317,6493319,6493321,6493327,6493329,6493333,6493335,6493337,6493341,6493343,6518377,6530919,6533709,6533725,6533733,6533753,6533759,6533771,6533777,6533795,6533801,6533809,6533817,6552455,6553859,6553877,6553885,6579395,6579397,6579401,6581641,6581643,6581647,6581651,6581663,6581739,6581745,6608097,6608099,6608105,6608109,6608111,6608115,6615223,7052403,7186355,7295417,7355299,7936113,8362637,9397833,10078485,10215613,10315697,10769803,10931011,11044455,11289857,11561571,11597749,11597751,11653837,11774759,11778443,11807821,11839161,11839345,11938839,12274497,13255425,13759085,13759089,13760725,13784973,13786343,13809337,13815619,13815623,13817141,13837885,13838817,13887443,13887451,13887457,13887467,13919395,13924963,13927519,13938711,13955527,13955535,13957439,13959613,13979767,13981507,14024377,14066107,14121683,14124935,14136603,14139351,14139357,14147025,14161495,14174897,14174903,14188459,14190401,14190403,14192555,14207019,14243031,14244479,14244637,14245407,14246413,14246933,14247221,14247271,14247549,14247551,14247553,14247557,14248325,14254817,14254865,14254959,14254995,14290525,14293317,14294819,14303101,14304667,14339159,14341597,14344083,14346805,14378345,14378373,14378379,14378387,14381551,14381577,14410897,14414513,14504939,14504945,14512163,14512167,14516135,14519651,14528333,14535725,14536671,14536679,14538249,14550739,14550773,14577365,14593249,14597229,14615113,14620187,14626281,14626297,14629143,14664403,14670217,14677245,14677255,14705613,14708251,14714247,14718429,14726181,14753631,14761593,14764773,14768893,14792981,14798317,14802655,14805759,14832241,14848011,14853319,14853333,14853347,14894751,14902403,14906947,14906953,23205535,28455815,30083923,30131537,30131553,30138797,30138807,30145179,30145189,30149489,30149495,30152921,30152937,30154755,30154759,30162273,30162291,30162309,30162333,30162403,30162621,30176959,30176989,30177031,30177065,30177185,30177443,30181735,30181757,30181769,30181789,30181803,30181825,30201117,30201139,30201167,30201193,30201219,30201257,30209969,30209985,30210003,30210013,30210025,30210045,30217499,30217513,30217529,30217545,30217561,30217579,30221769,30221781,30221789,30221801,30221817,30221835,30224891,30224903,30224913,30224921,30224929,30224945,30227897,30227905,30227915,30227925,30227937,30227959,30232817,30232827,30232839,30232849,30232865,30232887,30237619,30237631,30237647,30237655,30237665,30237681,30241951,30241969,30241991,30242007,30242023,30242037,30265339,30265363,30265397,30265423,30265513,30265731,30289201,30289221,30289239,30289261,30289285,30289339,30297169,30297185,30297195,30297205,30297225,30297245,30304637,30304653,30304665,30304681,30304703,30304721,30309881,30309889,30309897,30309907,30309919,30309931,30313279,30313287,30313289,30313297,30313303,30313307,30316941,30316989,30316997,30317005,30317025,30318949,30318953,30318957,30318961,30318965,30321257,30321259,30321261,30321265,30321267,30323029,30323037,30323043,30323047,30323053,30324063,30324067,30324073,30324077,30324081,30325183,30325187,30325191,30325195,30325201,30325711,30325715,30325719,30325723,30325725,30326463,30326469,30326471,30326473,30326477,30326989,30326991,30326993,30326995,30326997,30327359,30327363,30327365,30327367,30327371,30327667,30327671,30327675,30327679,30327683,30328235,30329049,30329055,30329061,30329065,30329069,30331535,30331541,30331547,30331555,30331561,30335045,30335053,30335065,30335075,30335087,30339701,30339711,30339721,30339731,30339739,30343665,30343679,30343691,30343709,30343723,30346587,30346617,30346629,30346667,30346685,30351027,30351037,30351047,30351057,30351063,30352623,30352627,30352641,30352647,30352657,30359123,30359135,30359145,30364131,30364157,30364189,30364225,30364241,30370111,30370129,30370149,30370197,30370217,30379455,30379463,30379471,30379479,30379487,30385665,30385673,30385683,30385691,30389745,30389755,30389767,30389777,30393055,30393065,30393073,30393079,30395605,30395611,30395619,30395629,30397039,30397043,30397047,30397051,30398475,30398481,30398485,30398489,30399579,30399583,30399585,30399591,30400733,30400737,30400741,30400749,30401509,30401517,30401521,30401529,30402197,30402199,30402201,30402203,30402979,30402981,30402983,30402985,30403915,30403947,30403977,30404087,30439609,30439643,30439673,30439767,30453813,30453831,30453845,30453877,30458063,30465467,30465481,30465497,30465513,30469831,30469843,30469857,30469875,30475161,30475173,30475191,30475209,30479235,30479239,30479253,30479265,30484129,30484133,30484141,30484153,30488925,30488941,30489075,30493049,30493055,30495689,30495701,30499439,30499449,30502843,30502851,30506657,30506667,30519955,30519977,30519999,30554287,30554297,30554303,30554309,30643853,30643881,30643947,30643955,30643965,30738641,30738663,30738717,30738727,30738745,30741709,30741711,30741713,30741715,30741717,30742543,30742547,30742551,30742555,30742559,30743395,30743397,30743399,30743401,30743403,30743875,30743879,30743883,30743887,30743891,30744865,30744867,30744869,30744871,30744873,30745019,30745727,30745731,30745739,30745745,30745749,30747665,30747671,30747677,30747681,30747685,30749017,30749019,30749021,30749023,30749025,30750619,30750625,30750631,30750637,30750641,30751755,30751757,30751759,30751761,30751763,30752899,30752905,30752911,30752917,30752923,30754153,30754155,30754157,30754159,30754161,30769971,30769977,30769983,30769991,30769997,30771831,30771837,30771841,30771845,30771851,30773287,30773297,30773321,30773343,30783557,30783573,30783591,30783607,30783623,30789617,30789629,30789639,30789651,30789663,30789737,30789753,30795301,30795315,30795325,30795341,30795355,30795365,30795381,30799393,30799401,30799411,30799419,30799427,30799437,30799447,30802667,30802677,30802683,30802695,30802703,30802715,30802723,30805175,30805181,30805185,30805191,30805195,30805201,30805207,30809235,30809255,30809269,30809285,30809301,30809317,30809331,30813193,30813205,30813217,30813231,30813245,30813257,30813269,30813277,30813285,30818577,30818593,30818605,30818623,30818637,30818651,30818661,30818667,30818677,30824539,30824553,30824565,30824583,30824597,30824609,30824625,30824639,30824651,30824663,30824675,30830485,30830497,30830505,30830517,30830525,30830539,30830557,30830571,30830589,30830603,30830619,30830635,30830653,30836779,30836787,30836799,30836811,30836821,30836829,30836837,30836845,30836851,30836863,30836873,30836883,30836887,30840987,30840995,30841007,30841019,30841029,30841043,30841055,30841067,30841077,30841091,30841103,30841111,30841121,30844667,30844673,30844679,30844685,30844691,30844697,30844703,30844711,30844717,30844723,30844731,30844757,30844767,30846947,30846957,30846963,30846965,30846971,30846977,30846981,30846987,30846991,30846995,30846999,30847009,30847011,30849495,30849499,30849503,30849507,30849511,30849515,30849519,30849523,30849525,30849529,30849533,30849537,30849541,30850695,30850697,30850699,30850701,30850703,30850705,30850709,30850713,30850715,30850721,30850723,30850727,30850729,30851899,30851903,30851907,30851909,30851913,30851917,30851921,30851925,30851929,30851933,30851939,30851943,30851947,30853275,30853279,30853281,30853283,30853285,30853287,30853291,30853295,30853299,30853303,30853307,30853311,30853317,30854405,30854417,30854425,30854433,30854443,30854455,30854465,30854475,30854485,30854495,30854503,30854509,30854517,30856471,30856477,30856481,30856485,30856489,30856495,30856499,30856505,30856509,30856513,30856517,30856521,30856527,30857665,30857669,30857675,30857681,30857683,30857687,30857691,30857697,30857705,30857711,30857717,30857721,30857731,30858291,30858295,30858299,30858303,30858307,30858311,30858313,30858317,30858321,30858325,30858327,30858331,30858335,30859147,30859149,30859151,30859153,30859155,30859157,30859159,30859161,30859163,30859165,30859167,30859169,30859171,30859673,30859677,30859681,30859685,30859689,30859693,30859695,30859699,30859703,30859707,30859711,30859715,30859719,30859903,30859905,30859907,30859909,30859911,30859913,30859915,30859917,30859919,30859921,30859923,30859925,30859927,30860521,30860523,30860525,30860527,30860529,30860531,30860533,30860535,30860537,30860539,30860541,30860543,30860545,30860775,30860779,30860783,30860785,30860789,30860793,30860797,30860801,30860805,30860809,30860815,30860819,30860825,30861409,30861927,30861933,30861939,30861945,30861949,30861955,30861961,30861965,30861971,30861979,30861985,30861989,30861993,30863937,30863939,30863941,30863945,30863947,30863953,30863955,30863957,30863961,30863993,30863999,30864005,30864011,30867425,30867435,30867443,30867457,30867467,30867483,30867493,30867507,30867513,30867523,30867535,30867547,30867555,30871431,30871437,30871443,30871449,30871455,30871461,30871467,30871473,30871479,30871487,30871497,30871505,30871513,30876081,30876097,30876113,30876127,30876143,30876161,30876179,30876197,30876217,30876239,30876261,30876279,30876299,30880169,30880173,30880179,30880187,30880195,30880205,30880215,30880233,30880251,30880269,30880281,30880293,30880305,30880319,30884969,30884975,30884981,30884987,30884995,30885001,30885007,30885015,30885023,30885033,30885041,30885047,30885055,30885063,30887313,30887319,30887327,30887337,30887345,30887361,30887373,30887383,30887391,30887405,30887419,30887431,30887443,30887457,30890633,30890641,30890647,30890653,30890657,30890661,30890669,30890677,30890683,30890689,30890695,30890697,30890701,30890705,30894249,30894263,30894273,30894287,30894299,30894319,30894337,30894347,30894367,30894377,30894391,30894403,30894417,30894427,30904037,30904063,30904083,30904135,30904157,30904181,30904249,30904275,30904299,30904325,30904377,30950801,30950831,30950845,30950857,30950875,30950887,30950947,30950959,30950991,30951593,30971507,30987501,30994997,30996139,30998461,30998465,30998467,30998471,30998475,30998479,30998483,30998491,30998495,30998943,31005199,31016423,31024113,31033233,31041119,31052627,31057459,31063357,31066179,31069725,31073147,31074831,31079439,31080599,31081315,31084745,31085727,31086815,31086817,31086821,31086823,31086831,31086839,31086841,31087587,31089763,31090765,31092441,31092929,31093255,31093257,31093469,31095927,31096435,31097705,31098017,31098019,31098021,31098023,31098025,31098027,31098029,31098803,31099051,31099057,31099061,31099067,31099073,31099081,31099087,31099611,31099615,31099617,31099621,31099625,31099629,31099633,31099835,31100875,31100895,31100897,31100899,31100903,31100907,31100909,31100911,31101527,31101667,31101671,31101675,31101679,31101695,31101699,31101703,31102349,31102351,31102357,31102363,31102371,31102379,31102385,31102463,31103011,31103013,31103015,31103017,31103019,31103021,31103023,31103103,31103729,31103731,31103735,31103737,31103823,31104287,31104293,31104299,31104305,31104325,31104329,31104333,31105057,31105059,31105061,31105063,31105065,31105067,31105069,31106415,31106419,31106423,31106427,31106431,31106435,31106439,31107781,31107783,31107785,31107787,31107789,31107791,31107793,31108257,31108259,31108261,31108263,31108463,31108465,31108467,31108469,31108667,31108669,31108671,31108673,31108675,31108677,31108679,31108871,31108873,31108875,31108877,31108879,31108881,31108883,31109105,31109107,31109109,31109111,31109113,31109115,31109117,31109355,31109357,31109359,31109361,31109625,31109627,31109629,31109631,31109633,31109637,31109639,31110155,31110157,31110159,31110161,31110163,31110167,31110173,31113217,31113225,31113233,31113241,31113251,31113261,31113269,31117831,31117835,31117837,31117841,31117845,31117849,31117853,31122957,31122961,31122967,31122973,31122981,31122987,31122991,31125889,31125899,31125911,31125921,31125933,31125947,31125955,31128643,31128649,31128653,31128657,31128661,31128665,31128669,31131277,31131281,31131285,31131289,31131307,31131311,31131319,31134753,31134777,31134785,31134797,31134807,31134813,31134823,31134833,31141803,31141815,31141821,31141839,31141845,31141867,31141877,31141881,31148005,31148027,31148035,31148047,31148059,31148071,31148083,31148095,31153709,31153713,31153717,31153719,31153721,31153723,31153727,31153731,31153745,31153747,31153749,31153753,31153755,31159687,31159697,31159709,31159721,31159735,31159745,31159755,31159759,31159769,31159777,31159781,31159789,31159797,31162425,31162435,31162445,31162455,31162479,31162491,31162501,31162507,31162521,31162537,31162547,31162559,31162563,31164679,31164685,31164691,31164697,31164701,31164709,31164717,31164723,31164727,31164733,31164737,31164745,31164753,31165939,31165941,31165943,31165945,31165947,31165949,31165951,31165953,31165955,31165957,31165959,31165961,31165963,31167477,31167479,31167481,31167483,31167485,31167487,31167489,31167491,31167493,31167495,31167497,31167499,31167501,31168503,31168505,31168507,31168509,31168511,31168513,31168515,31168517,31168519,31168521,31168523,31168525,31168527,31169053,31169055,31169059,31169063,31169065,31169069,31169073,31169075,31169077,31169079,31169081,31169083,31169085,31169891,31169895,31169899,31169903,31169907,31169911,31169915,31169919,31169923,31169927,31169931,31169933,31169937,31170989,31170993,31170997,31171001,31171005,31171007,31171011,31171015,31171019,31171023,31171027,31171031,31171035,31172545,31172547,31172549,31172551,31172553,31172555,31172557,31172559,31172561,31172563,31172565,31172567,31172569,31172897,31172899,31172901,31172903,31172905,31172907,31172909,31172911,31172913,31172915,31172917,31172919,31172921,31173175,31173177,31173179,31173181,31173183,31173185,31173187,31173189,31173191,31173193,31173195,31173197,31173199,31173203,31173205,31173207,31173209,31173211,31173213,31173215,31173217,31173219,31173221,31173223,31173225,31173227,31173291,31173293,31173295,31173297,31173299,31173301,31173303,31173305,31173307,31173309,31173311,31173313,31173315,31175375,31175385,31175395,31175405,31175415,31175427,31175437,31175445,31175449,31175455,31175459,31175465,31175469,31177853,31177855,31177861,31177865,31177867,31177869,31177871,31177881,31177889,31177891,31177897,31177903,31177909,31182539,31182549,31182561,31182567,31182571,31182579,31182589,31182597,31182601,31182605,31182615,31182621,31182627,31187439,31187455,31187465,31187473,31187477,31187489,31187499,31187511,31187525,31187539,31187551,31187563,31192951,31192957,31192963,31192969,31192975,31192981,31192987,31192995,31192997,31193003,31193009,31193015,31196009,31196019,31196027,31196039,31196047,31196055,31196065,31196073,31196083,31196093,31196101,31196105,31200043,31200057,31200065,31200075,31200083,31200091,31200099,31200105,31200109,31200115,31200121,31200127,31203989,31203997,31204005,31204013,31204021,31204027,31204035,31204045,31204053,31204061,31204069,31204077,31204085,31209239,31209257,31209307,31209323,31209337,31209351,31209367,31209377,31209389,31209399,31209409,31216161,31216181,31216193,31216207,31216223,31216239,31216253,31216265,31216277,31216289,31219923,31219925,31219943,31219947,31219951,31229917,31229923,31229937,31229943,31229949,31235873,31235883,31235895,31235903,31235913,31238823,31238833,31238841,31238849,31238859,31241981,31241989,31242001,31242009,31247281,31247285,31247295,31247301,31252107,31252117,31252129,31252167,31252173,31258257,31258265,31258305,31258391,31264475,31264485,31264491,31268515,31268521,31268529,31271651,31271659,31271667,31273787,31273789,31273791,31275565,31275569,31275575,31276293,31276295,31276297,31277269,31277271,31277273,31279327,31279331,31279337,31280623,31280625,31280627,31281135,31281137,31281139,31291813,31291855,31291881,31291909,31291929,31291951,31291973,31329863,31329875,31329883,31329897,31329921,31329935,31329949,31347021,31347087,31347103,31347125,31347141,31347173,31347195,31347215,31359811,31359873,31359893,31359905,31359923,31359939,31373513,31373533,31373553,31373563,31373579,31373591,31387733,31387745,31387759,31387769,31387785,31387801,31397429,31397435,31397443,31397453,31397461,31397471,31397481,31401905,31401911,31401923,31401929,31401935,31401945,31401953,31408075,31408099,31408121,31408211,31408237,31408335,31408419,31460805,31460815,31460825,31460835,31460843,31460863,31460875,31477873,31477879,31477885,31477905,31477913,31477921,31477933,31484853,31484863,31484869,31484879,31484891,31484903,31484917,31492183,31492189,31492193,31492201,31492211,31492219,31492229,31507023,31507031,31507039,31507047,31507055,31507063,31507069,31522631,31522647,31522687,31522699,31522713,31534959,31534967,31534979,31535001,31535009,31559817,31559893,31559907,31559925,31572809,31572819,31572841,31572851,31572861,31576807,31576809,31576817,31576821,31576827,31580965,31580973,31580995,31581007,31581017,31581027,31583929,31583937,31583947,31583953,31583963,31583971,31583981,31583989,31583999,31587931,31587937,31587945,31587953,31587959,31587963,31587971,31587981,31587989,31589915,31589923,31589927,31589931,31589937,31589941,31589951,31589955,31589965,31594107,31594125,31594139,31594151,31594171,31594195,31594213,31594233,31594253,31594271,31594289,31598953,31598967,31598973,31598983,31598993,31599005,31599015,31599021,31599027,31599033,31599037,31604765,31604773,31604781,31604787,31604799,31604809,31604819,31604829,31604839,31609817,31609849,31609869,31609883,31614395,31614405,31614415,31618559,31618569,31618579,31622035,31622041,31622049,31624895,31624903,31624909,31627859,31627861,31627865,31629987,31629997,31630009,31633309,31633311,31633313,31635447,31635451,31635457,31636681,31636725,31636729,31637877,31637883,31637889,31639161,31639163,31639549,31639551,31640431,31640487,31640489,31640719,31640775,31641841,31641847,31643297,31643307,31645545,31645571,31649635,31649641,31649647,31649663,31649669,31653055,31653067,31653079,31653089,31653105,31653117,31655623,31655629,31655635,31655641,31655647,31655655,31655665,31655673,31655679,31659017,31659023,31659027,31659033,31659041,31659049,31659051,31659059,31659067,31661641,31661653,31661663,31661675,31661685,31661693,31661703,31661715,31661725,31664219,31664227,31664233,31664237,31664245,31664251,31664257,31664265,31664271,31667267,31667273,31667285,31667299,31667305,31667313,31667319,31667327,31667335,31670685,31670693,31670699,31670707,31670717,31670727,31670737,31670749,31670763,31676263,31676273,31676277,31676285,31676291,31676297,31676301,31676305,31676309,31679375,31679391,31679415,31679433,31679447,31679463,31679475,31761393,31761401,31761405,31761417,31762447,31762453,31762459,31762467,31762477,31762485,31827387,31827409,31827415,31827421,31827429,31827463,31827491,31839649,31839663,31843669,31843681,31846765,31846773,31850455,31850457,31852193,31852199,31855835,31855839,31859171,31859175,31864155,31864165,31870673,31870687,31877077,31877093,31881351,31881359,31884339,31884341,31888433,31888439,31890135,31890159,31890187,31890193,31890201,31890207,31891903,31891907,31893841,31893851,31896185,31896189,31897823,31897827,31899387,31899391,31900025,31900027,31900337,31900341,31900853,31900855,31901179,31901185,31901805,31901809,31902133,31902139,31902747,31902749,31904133,31904137,31906505,31906513,31912249,31912257,31916705,31916711,31920617,31920621,31924305,31924309,31928847,31928851,31933519,31933533,31937315,31937353,31937363,31937403,31942793,31942801,31950893,31950907,31953481,31953519,31953531,31953543,31953565,31956251,31956263,31958917,31958925,31960351,31960353,31961863,31961871,31961883,31961891,31963495,31963499,31964507,31964509,31964513,31964517,31965073,31965077,31966615,31966617,31966623,31966629,31966877,31966887,31968329,31968331,31968333,31968335,31968369,31968371,31968593,31968597,31968601,31968605,31969289,31969299,31971339,31971347,31971355,31971361,31971649,31971653,31971955,31971957,31971959,31971961,31971965,31971967,31972959,31972963,31972967,31972971,31973005,31973009,31973421,31973423,31973425,31973427,31973429,31973431,31973921,31973925,31974171,31974175,31974179,31974183,31974647,31974695,31974697,31974699,31974701,31974719,31974721,31974723,31974725,31975259,31975261,31975263,31975267,31975269,31975271,31975273,31975275,31975277,31975863,31975867,31977279,31977283,31977287,31977291,31977493,31977497,31978075,31978077,31978079,31978081,31978399,31978411,31980281,31980287,31980293,31980299,31980623,31980625,31980867,31980873,31980881,31980885,31981045,31981047,31981487,31981489,31981491,31981493,31981527,31981529,31981747,31981749,31981751,31981753,31981757,31981955,31981959,31981963,31981967,31982247,31982251,31982493,31982495,31982497,31982499,31982535,31982537,31982991,31982997,31983003,31983009,31983389,31983391,31984195,31984197,31984199,31984201,31984429,31984431,31984675,31984679,31984683,31984689,31985025,31985029,31985991,31985993,31985995,31985997,31986179,31986181,31986415,31986417,31986419,31986421,31986501,31986505,31987685,31987693,31987701,31987709,31987925,31987931,31988371,31988373,31988375,31988377,31988391,31988393,31989081,31989085,31989091,31989095,31989177,31989183,31989819,31989821,31989823,31989825,31989853,31989857,31990211,31990215,31990219,31990223,31990231,31990233,31990299,31990301,31990303,31990305,31990307,31990309,31990993,31991179,31991183,31991187,31991191,31992107,31992375,31992379,31992383,31992387,31993613,31993615,31993617,31993619,31993621,31993803,31993923,31993927,31993931,31993935,31994307,31994309,31994311,31994313,31994315,31994611,31994671,31994673,31994675,31994677,31994709,31994711,31994713,31994715,31994717,31994739,31994741,31994743,31994745,31994747,31994757,31994759,31994761,31994763,31994765,31994773,31994775,31994777,31994779,31994783,31995443,31995445,31995447,31995449,31995451,31995457,31995459,31995461,31995463,31995489,31997141,31997145,31997149,31997153,31997287,31997673,31997677,31997681,31997685,31998361,31998387,31998389,31998391,31998393,31998563,31998869,31998873,31998879,31998883,31999445,31999537,31999539,31999541,31999543,31999857,32000367,32000371,32000375,32000377,32000575,32000679,32000681,32000683,32000687,32001385,32001517,32001519,32001521,32001523,32001665,32002063,32002067,32002071,32002075,32002603,32002689,32002691,32002693,32002695,32003289,32003849,32003855,32003859,32003863,32004689,32004835,32004837,32004839,32004841,32005793,32005889,32005891,32005893,32005895,32006081,32006163,32006167,32006171,32006177,32006979,32006981,32006983,32006985,32006987,32007439,32007555,32007557,32007563,32007567,32008305,32008307,32008309,32008311,32008313,32008789,32009103,32009105,32009107,32009109,32009223,32009659,32009663,32009669,32009675,32011181,32011185,32011189,32011191,32011655,32011657,32011659,32011661,32011779,32011783,32011787,32011793,32011967,32011969,32011971,32011973,32012153,32012155,32012157,32012159,32012351,32012353,32012355,32012357,32012383,32012385,32012387,32012389,32012587,32012589,32012591,32012593,32012853,32012855,32012857,32012859,32013167,32013173,32013179,32013185,32013191,32014063,32014069,32014075,32014081,32040983,32041009,32014515,32014517,32014519,32014521,32014761,32014767,32014771,32014775,32051927,32052045,32052055,32052073,32053177,32053199,32015685,32015687,32015689,32015699,32067303,32067321,32017999,32018013,32018105,32018109,32018115,32018121,32076717,32076731,32076951,32076991,32077023,32020867,32020873,32021401,32021409,32021419,32021427,32023621,32023631,32024673,32024683,32024693,32024703,32027487,32027495,32028023,32028029,32028035,32028045,32030031,32030033,32030391,32030395,32030397,32030399,32129953,32130225,32032519,32032535,32033789,32033797,32033803,32033809,32146797,32146867,32147191,32147317,32035111,32035127,32036019,32036025,32036031,32036037,32037655,32037673,32037689,32044289,32044299,32044307,32201053,32201109,32201325,32201415,32051061,32051079,32051097,32059239,32059257,32059273,32059287,32068065,32068079,32068095,32068103,32076939,32076979,32077017,32077055,32085285,32085457,32085487,32085517,32093685,32093697,32093711,32093723,32106471,32106509,32106541,32106573,32134615,32134665,32134707,32134749,32154503,32154553,32154605,32154651,32171257,32171281,32171311,32171335,32184479,32184515,32184551,32184585,32197803,32207059,32207199,32232691,32232899,32233149,32233259,32233363,32250473,32250675,32257057,32257131,32257223,32273711,32273883,32299115,32299315,32302139,32302217,32302319,32326171,32326299,32339055,32339161,32339301,32353867,32354063,32370803,32370885,32370993,32380563,32380719,32402589,32402657,32402755,32407395,32407561,32432347,32432473,32433883,32433953,32434045,32468275,32468927,32469071,32477671,32477715,32477801,32491645,32492487,32492661,32506837,32506921,32507013,32510993,32511765,32511919,32534311,32535309,32535485,32536835,32536927,32537043,32554339,32554407,32554499,32556985,32557467,32557559,32580029,32580889,32581049,32587409,32587443,32587483,32587739,32587847,32612077,32612981,32613171,32625891,32625993,32626027,32626053,32626265,32656017,32656089,32656113,32656135,32656283,32658911,32658973,32658999,32671733,32671833,32671885,32677451,32677583,32677595,32677613,32677731,32689315,32689453,32689549,32689593,32707543,32707727,32707833,32707889,32713143,32713757,32713845,32713877,32713899,32732001,32732145,32732229,32732277,32733007,32749851,32750085,32750171,32750201,32750231,32751965,32752133,32752237,32752287,32642705,32643435,32643535,32770007,32770415,32770471,32770491,32770511,32772499,32772661,32772759,32772809,32786585,32787119,32787175,32787197,32787215,32789757,32789901,32790001,32790061,32806119,32806153,32806209,32806231,32806251,32808889,32809057,32809157,32809199,32826425,32826565,32826651,32826685,32827349,32827369,32827425,32827441,32827461,32846765,32846895,32846989,32847033,32848171,32865721,32865803,32865919,32865947,32867593,32867611,32867659,32867675,32867689,32885217,32885343,32885421,32885459,32890551,32890561,32890595,32890607,32890619,32900343,32900467,32900555,32900591,32917339,32917363,32917855,32917917,32917939,32918063,32918837,32919119,32919309,32919425,32919525,32944747,32944787,32944809,32944833,32944909,32944979,32945005,32946603,32946909,32947123,32947241,32947303,32975113,32975307,32975415,32975511,32975557,32982063,32982129,32982197,32982231,32983567,32983649,32983677,32983705,33010731,33011045,33011393,33011647,33011695,33061677,33061731,33061791,33061825,33062055,33063093,33063391,33063615,33063741,33063809,33091049,33091341,33091565,33091709,33091777,33099773,33099913,33099967,33100021,33100043,33100069,33124235,33124503,33124709,33124851,33124913,33138543,33138647,33138685,33138735,33138757,33138783,33149601,33149905,33150077,33150221,33150275,33208415,33208861,33209069,33209181,33209241,33218973,33219111,33219155,33219209,33219233,33219261,33242393,33242509,33242551,33242591,33242607,33243053,33259047,33259333,33259519,33280771,33280789,33280893,33280933,33280973,33280993,33288025,33288307,33288491,33315827,33315865,33315905,33317277,33317609,33317845,33322955,33322977,33323003,33323025,33323051,33323185,33341659,33341687,33341711,33342803,33343157,33343395,33363647,33363667,33363687,33363713,33363743,33363773,33368865,33368895,33368931,33370041,33370303,33370459,33399453,33399481,33399505,33400801,33401151,33401471,33409323,33409353,33409379,33409415,33409457,33409485,33458845,33458871,33459013,33459047,33459079,33459111,33459147,33459169,33464501,33464523,33464551,33465693,33466071,33466345,33505433,33505455,33505551,33505571,33505591,33505611,33505631,33505651,33522523,33522543,33522565,33523403,33523655,33523827,33550211,33550245,33550401,33550431,33550463,33550491,33550521,33550549,33584595,33584623,33584649,33585843,33586237,33586489,33588435,33588467,33588625,33588655,33588691,33588723,33588757,33588795,33633803,33633835,33633995,33634023,33634053,33634079,33634111,33634141,33640085,33640169,33640199,33641359,33641667,33641881,33657907,33657927,33658019,33658041,33658061,33658079,33658099,33658117,33675789,33675811,33675831,33676859,33677119,33696195,33696217,33696465,33696497,33696525,33696555,33696587,33696619,33724005,33724023,33725021,33725271,33735537,33735571,33735733,33735765,33735799,33735827,33735859,33735887,33769973,33769999,33771017,33771467,33773991,33774027,33774199,33774233,33774267,33774301,33774335,33774369,33812397,33812417,33812529,33812549,33812575,33812601,33812625,33812651,33815313,33815335,33816245,33816507,33854695,33854715,33854819,33854841,33854863,33854881,33854903,33854927,33871041,33871065,33872283,33872567,33892145,33892179,33893499,33893843,33912435,33912459,33912587,33912613,33912635,33912747,33912783,33912807,33939861,33939885,33940849,33941249,33951161,33951189,33951331,33951359,33951389,33951415,33951441,33951467,33989105,33989131,33990489,33992557,33992583,33992723,33992749,33992777,33992803,33992831,33992859,34033563,34033593,34033729,34033757,34033781,34033805,34033833,34033853,34048301,34048329,34049735,34064161,34064179,34064265,34064281,34064297,34064315,34064335,34064351,34076855,34076889,34096091,34096117,34096235,34096259,34096281,34096301,34096329,34096351,34115509,34115531,34134153,34134173,34134283,34134305,34134325,34134349,34134379,34134397,34162755,34162783,34170151,34170173,34170297,34170325,34170351,34170379,34170409,34170437,34198729,34198743,34198843,34198867,34198891,34198919,34198947,34198965,34204211,34204221,34222593,34222625,34233093,34233121,34233257,34233281,34233309,34233335,34233367,34233391,34255761,34255793,34265881,34265905,34266031,34266051,34266079,34266107,34266133,34266161,34291129,34291153,34300993,34301015,34301121,34301143,34301163,34301183,34301207,34301229,34314411,34314443,34320343,34320373,34320527,34320559,34320593,34320629,34320661,34320697,34333317,34333355,34346459,34346487,34346611,34346637,34346663,34346691,34346717,34346741,34381617,34381643,34381781,34381807,34381835,34381865,34381889,34381915,34382829,34382859,34398851,34398861,34398915,34398923,34398931,34398941,34398951,34407441,34407469,34425619,34425641,34425741,34425763,34425781,34425809,34425833,34439005,34439021,34440435,34440455,34440557,34440575,34440595,34440615,34458741,34458893,34473301,34473401,34473427,34473565,34473587,34473615,34473641,34491179,34491201,34504883,34505001,34505031,34505197,34505227,34505261,34505297,34539591,34539623,34541355,34541447,34541575,34541605,34541767,34576867,34576889,34579711,34579769,34579795,34579847,34579933,34580041,34580065,34612285,34612315,34618155,34618207,34618237,34618291,34618371,34618475,34618501,34648231,34648251,34653255,34653293,34653313,34653353,34653415,34653497,34653517,34677105,34677133,34686937,34686991,34687019,34687073,34687151,34687251,34687277,34721279,34721301,34721629,34721675,34721701,34721753,34721827,34721917,34721935,34754951,34754973,34756281,34756323,34756345,34756389,34756451,34756537,34756559,34794581,34794625,34794647,34794695,34794759,34808141,34808189,34808213,34808259,34808329,34836221,34836265,34836311,34836359,34836381,34836429,34836511,34866419,34866457,34866499,34866541,34866565,34866609,34866671,34896451,34896475,34896531,34896593,34896659,34896687,34896741,34896821,34927895,34927919,34927967,34928011,34928043,34928061,34928091,34928145,34962141,34962165,34962195,34962313,34962343,34962409,34962467,34962525,34962551,34999239,34999261,34999287,34999369,34999383,34999429,34999479,34999529,34999553,35032113,35032137,35032161,35032259,35032409,35032455,35032507,35032555,35032579,35064965,35064991,35065015,35065095,35065117,35065159,35065201,35065243,35065263,35076007,35095867,35095895,35095917,35096007,35096029,35096071,35096119,35096163,35096187,35103985,35129407,35129431,35129455,35129545,35129567,35129621,35129795,35129847,35129873,35145623,35160737,35160763,35160791,35160897,35160925,35160975,35161025,35161073,35161097,35170177,35190067,35190097,35190133,35190257,35190283,35190343,35190413,35190471,35205279,35205605,35228035,35228099,35228159,35228189,35228217,35228329,35228357,35228413,35252399,35252745,35265469,35265497,35265559,35265613,35265639,35265669,35265777,35265803,35306071,35306107,35306177,35306245,35306275,35306307,35306431,35306461,35311227,35342777,35342815,35342845,35342919,35342949,35343007,35343051,35343121,35343201,35343233,35355771,35356157,35356555,35390671,35390697,35390717,35390759,35390785,35390851,35390883,35390941,35390999,35391025,35413475,35413913,35414311,35433667,35433693,35433713,35433761,35433785,35433833,35433853,35433905,35433961,35433991,35449759,35450163,35450579,35474635,35474669,35474703,35474783,35474821,35474895,35474935,35474999,35475063,35475093,35489431,35489755,35490107,35517679,35517705,35517733,35517785,35517815,35517871,35517899,35517947,35517995,35518017,35538953,35539251,35539537,35560339,35560365,35560387,35560439,35560465,35560515,35560541,35560585,35560637,35560661,35595623,35595921,35596205,35597165,35597189,35597213,35597259,35597281,35597327,35597349,35597393,35597435,35597457,35625423,35625471,35625489,35625513,35625555,35625565,35625623,35625671,35625769,35639599,35639743,35640007,35640275,35669417,35669437,35669507,35669529,35669551,35669593,35669615,35669655,35669675,35694889,35695073,35695419,35695717,35711843,35711861,35711929,35711975,35712127,35712179,35712207,35712257,35712277,35752071,35752265,35752623,35752963,35754665,35754691,35754851,35754875,35754907,35754971,35754999,35791203,35791291,35791319,35791457,35791491,35791523,35791591,35791625,35811651,35811929,35812427,35812769,35839617,35839641,35839711,35839733,35839857,35839883,35839905,35839961,35867325,35867353,35867447,35867477,35867623,35867653,35867677,35867733,35873187,35873365,35873747,35874083,35899395,35899421,35899499,35899523,35899647,35899675,35899699,35899747,35927733,35928825,35929113,35930053,35930513,35947397,35947417,35947437,35947457,35947525,35947541,35947637,35947659,35973237,35974069,35974283,35974697,35975071,35993055,35993077,35993099,35993123,35993237,35993255,36033425,36034187,36034361,36034665,36034699,36034973,36044647,36044901,36044933,36044967,36045003,36086591,36086599,36086637,36086819,36086837,36087899,36087915,36088467,36117787,36117819,36117887,36118165,36118189,36132573,36132597,36133549,36137203,36137231,36137291,36137479,36137507,36154913,36166455,36181107,36195367,36195475,36195515,36223341,36223363,36223381,36223445,36223563,36223575,36223607,36247747,36247771,36247795,36247859,36247967,36248011,36259491,36277091,36277125,36277155,36277241,36277377,36277433,36308823,36308855,36308883,36308977,36309123,36309225,36311645,36171251,36190523,36344117,36344145,36344171,36344243,36344369,36205255,36358147,36218881,36376179,36376207,36376237,36376375,36376519,36229631,36240215,36404481,36251915,36406635,36406657,36406679,36406749,36406861,36267705,36281631,36434655,36434677,36434701,36434775,36434887,36444219,36294577,36308257,36465307,36465329,36465349,36465433,36465587,36323087,36486477,36343219,36494419,36494441,36494469,36494549,36494677,36358151,36374757,36522443,36522467,36522491,36522561,36522679,36524537,36388973,36403657,36419349,36435175,36546661,36552025,36552053,36552077,36552153,36552279,36454961,36471535,36482499,36586903,36586927,36588067,36496967,36509743,36618541,36618563,36618589,36618667,36521129,36529705,36663783,36663803,36663821,36663843,36677579,36677595,36677837,36688131,36688159,36688185,36548181,36561643,36573275,36717649,36717679,36717713,36717741,36717773,36717881,36728905,36728919,36729169,36586861,36595511,36747701,36747731,36747759,36747787,36747809,36747931,36612645,36626219,36640041,36642089,36642111,36643251,36793297,36793349,36646971,36646989,36647009,36647077,36796151,36653325,36811645,36811681,36811715,36811751,36811785,36812115,36665037,36676265,36686239,36867375,36867415,36867453,36867491,36867531,36867849,36700607,36717387,36915813,36915833,36915853,36915879,36915905,36916151,36732207,36748729,36763559,36963795,36963827,36963857,36963887,36963917,36964195,36815275,36859591,37011543,37011577,37011613,37011645,37011671,36882109,37033149
# ]
    num=0
    bugid=[]
    for args in  all_id:
        num += 1
        print(num)
        if excute_mysql(f"select  id ,url,title,senddate from dede_arctiny where id ='{args}';"):
            excute_mysql(f"delete from dede_arctiny where id='{args}';", commit=True)
            print(f'dede_arctiny delete {args}')
        else:
            print(f'dede_arctiny delete {args} not find')
        if excute_mysql(f"select  aid ,url,title,senddate from dede_addoninfos9 where aid ='{args}';"):
            excute_mysql(f"delete from dede_addoninfos9 where aid='{args}';", commit=True)
            print(f'dede_addoninfos2 delete {args}')
        else:
            bugid.append(args)
            print(f'dede_addoninfos2 delete {args} not find')
    print(bugid)

if __name__ == '__main__':
    # data=excute_mysql(f"select  id ,url,title,senddate from dede_arctiny where title ='';")
    data=json.loads(get_aid_api())['aid']
    # data=[]
    print(data)
    all_id=[]
    for ev in  data:
        print(ev)
        search_data(ev)
        # all_id.append(ev[0])
    # print(all_id)
    # run_(data)  #先查主表 在查附表 再删除
    #
    # jl = alashan_ggzy()
    # num=0
    # for data in aids:
    #     print(data)

    # print(tool.removal('青州市邵庄镇南文登村石灰岩矿废弃矿坑地质...','2023-8-16'))



    # print(search_arctiny('59986053'))
    # print(search_addoninfos('59986053'))
    # print(del_('59986053'))

        # code= jl.parse_detile(data[2], data[1], data[3])
        # print(code)

        #     sheng=7500
        #     update_sheng(id, sheng)
        #     if data[1]!=8002.0:
        # shi=7502
        # update_shi(data, 9004)
        # num+=1
        # print(data,'update complate',num)
        # id=data[0]
        # updata_body(id,code)

